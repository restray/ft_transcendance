// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Status {
  ONLINE
  AWAY
  PLAYING
  OFFLINE
}

model User {
  id              Int     @id @default(autoincrement())
  name            String  @unique
  status          Status  @default(OFFLINE)
  avatar          String?
  otp_secret      String?
  otp_enable      Boolean @default(false)
  intra_id        String  @unique
  friendRequest   FriendShip[] @relation("friends_requests")
  friendProposal  FriendShip[] @relation("friends_proposals")
}

enum FriendShipStatus {
  WAITING
  DENIED
  ACCEPTED
  BLOCKED
}

model FriendShip {
  requester    User @relation("friends_requests", fields: [requesterId], references: [id])
  requesterId  Int
  receiver     User @relation("friends_proposals", fields: [receiverId], references: [id])
  receiverId   Int
  status       FriendShipStatus @default(WAITING)

  @@id([requesterId, receiverId])
}
